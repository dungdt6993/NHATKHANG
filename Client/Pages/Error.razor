@using D69soft.Client.Services;
@using D69soft.Shared.Models.ViewModels.SYSTEM;

<!-- Main content -->
<section class="content">
    <div class="container-fluid">
        <div class="error-page text-center">
            <h2 class="headline text-danger">500</h2>

            <div class="error-content">
                <h3 class="text-danger"><i class="fas fa-exclamation-triangle text-danger"></i> Cảnh báo! Có lỗi hệ thống xảy ra.</h3>

                <p>
                    Liên hệ quản trị viên để khắc phục hệ thống.
                </p>

                <i class="fa-solid fa-bug fa-5x"></i>

            </div>
        </div>
        <!-- /.error-page -->
    </div>
</section>
<!-- /.content -->
@code {
    [Inject] SysService sysService { get; set; }

    [Parameter]
    public Exception exception { get; set; }

    ErrorLogVM errorLogVM = new();

    protected override async Task OnInitializedAsync()
    {
        if (exception is not null)
        {
            errorLogVM.ErrType = exception.GetType().ToString();
            errorLogVM.ErrMessage = exception.Message;
            errorLogVM.ErrTime = DateTime.Now;
            errorLogVM.ErrNote = Directory.GetCurrentDirectory();

            await sysService.ErrorLog(errorLogVM);
        }
    }
}